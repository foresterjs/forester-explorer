{"version":3,"sources":["../lib/index.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;QAiBG,WAAW,GAAX,WAAW;;;;AAf3B,MAAM,MAAM,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;;AAE5C,MAAM,CAAC,OAAO,GAAG,UAAU,QAAQ,EAAE;;AAEnC,UAAQ,CAAC,mBAAmB,CAAC,EAAC,KAAK,EAAE,WAAW,EAAE,IAAI,EAAE,SAAS,GAAG,SAAS,EAAC,CAAC,CAAC;;AAEhF,UAAQ,CAAC,GAAG,CAAC,GAAG,CACd,MAAM,CAAC,UAAA,CAAC,EAAI;AACV,KAAC,CAAC,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC,EAAC,WAAW,EAAE,QAAQ,CAAC,WAAW,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAC,CAAC,CAAC,CAAC;GACzF,CAAC,CACH,CAAC;CAEH,CAAC;;AAGK,SAAS,WAAW,OAAsB;MAApB,WAAW,QAAX,WAAW;MAAE,IAAI,QAAJ,IAAI;;AAC5C;gCAAO,kBAAqC,IAAI,EAAE;UAA1B,OAAO,SAAP,OAAO;UAAE,QAAQ,SAAR,QAAQ;;AACvC,UAAI,oBAAoB,GAAG,EAAE,CAAC;;AAE9B,WAAK,IAAI,cAAc,IAAI,WAAW,EAAE;AACtC,YAAI,gBAAgB,GAAG,WAAW,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC;AAC1D,4BAAoB,CAAC,IAAI,CAAC;AACxB,cAAI,EAAE,cAAc;AACpB,oBAAU,EAAE,gBAAgB,CAAC,UAAU;AACvC,mBAAS,EAAE,gBAAgB,CAAC,SAAS;AACrC,mBAAS,EAAE,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE;SAC7C,CAAC,CAAC;OACJ;;AAED,cAAQ,CAAC,IAAI,GAAG,oBAAoB,CAAC;;AAErC,YAAM,IAAI,CAAC;KACZ;;;;;OAAA;CACF","file":"index.js","sourcesContent":["\"use strict\";\n\nconst router = require('koa-simple-router');\n\nmodule.exports = function (forester) {\n\n  forester.registerStaticRoute({route: '/explorer', path: __dirname + '/public'});\n\n  forester.koa.use(\n    router(_ => {\n      _.get('/schema', serveSchema({collections: forester.collections, rest: forester.rest}));\n    })\n  );\n\n};\n\n\nexport function serveSchema({collections, rest}) {\n  return async function ({request, response}, next) {\n    var endpointsDescription = [];\n\n    for (var collectionName in collections) {\n      var collectionSchema = collections[collectionName].schema;\n      endpointsDescription.push({\n        name: collectionName,\n        properties: collectionSchema.properties,\n        relations: collectionSchema.relations,\n        endpoints: rest.routes[collectionName] || []\n      });\n    }\n\n    response.body = endpointsDescription;\n\n    await next;\n  }\n}\n"]}